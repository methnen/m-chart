(()=>{var e={873:(e,t,r)=>{var a=r(325).Symbol;e.exports=a},552:(e,t,r)=>{var a=r(873),n=r(659),c=r(350),o=a?a.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?n(e):c(e)}},128:(e,t,r)=>{var a=r(800),n=/^\s+/;e.exports=function(e){return e?e.slice(0,a(e)+1).replace(n,""):e}},840:(e,t,r)=>{var a="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=a},659:(e,t,r)=>{var a=r(873),n=Object.prototype,c=n.hasOwnProperty,o=n.toString,l=a?a.toStringTag:void 0;e.exports=function(e){var t=c.call(e,l),r=e[l];try{e[l]=void 0;var a=!0}catch(e){}var n=o.call(e);return a&&(t?e[l]=r:delete e[l]),n}},350:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},325:(e,t,r)=>{var a=r(840),n="object"==typeof self&&self&&self.Object===Object&&self,c=a||n||Function("return this")();e.exports=c},800:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},221:(e,t,r)=>{var a=r(805),n=r(124),c=r(374),o=Math.max,l=Math.min;e.exports=function(e,t,r){var i,s,m,u,p,h,d=0,f=!1,v=!1,b=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function E(t){var r=i,a=s;return i=s=void 0,d=t,u=e.apply(a,r)}function g(e){var r=e-h;return void 0===h||r>=t||r<0||v&&e-d>=m}function w(){var e=n();if(g(e))return y(e);p=setTimeout(w,function(e){var r=t-(e-h);return v?l(r,m-(e-d)):r}(e))}function y(e){return p=void 0,b&&i?E(e):(i=s=void 0,u)}function N(){var e=n(),r=g(e);if(i=arguments,s=this,h=e,r){if(void 0===p)return function(e){return d=e,p=setTimeout(w,t),f?E(e):u}(h);if(v)return clearTimeout(p),p=setTimeout(w,t),E(h)}return void 0===p&&(p=setTimeout(w,t)),u}return t=c(t)||0,a(r)&&(f=!!r.leading,m=(v="maxWait"in r)?o(c(r.maxWait)||0,t):m,b="trailing"in r?!!r.trailing:b),N.cancel=function(){void 0!==p&&clearTimeout(p),d=0,i=h=s=p=void 0},N.flush=function(){return void 0===p?u:y(n())},N}},805:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},346:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},394:(e,t,r)=>{var a=r(552),n=r(346);e.exports=function(e){return"symbol"==typeof e||n(e)&&"[object Symbol]"==a(e)}},124:(e,t,r)=>{var a=r(325);e.exports=function(){return a.Date.now()}},374:(e,t,r)=>{var a=r(128),n=r(805),c=r(394),o=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(c(e))return NaN;if(n(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=n(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=a(e);var r=l.test(e);return r||i.test(e)?s(e.slice(2),r?2:8):o.test(e)?NaN:+e}}},t={};function r(a){var n=t[a];if(void 0!==n)return n.exports;var c=t[a]={exports:{}};return e[a](c,c.exports,r),c.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.i18n,t=window.wp.blocks,a=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"m-chart/chart","title":"M Chart","category":"layout","icon":"chart-pie","description":"Embed a chart made with M Chart into your posts and pages","textdomain":"m-chart","attributes":{"chartId":{"type":"string","default":""}},"supports":{"html":false},"editorScript":"m-chart-editor","editorStyle":"m-chart-editor-style","render":"file:./render.php"}'),n=window.React,c=window.wp.components,o=window.wp.element,l=window.wp.blockEditor,i=window.wp.apiFetch;var s=r.n(i),m=r(221),u=r.n(m);(0,t.registerBlockType)(a,{edit:function({attributes:t,setAttributes:r}){const[a,i]=(0,o.useState)([]),[m,p]=(0,o.useState)(""),[h,d]=(0,o.useState)(0),[f,v]=(0,o.useState)(0),[b,E]=(0,o.useState)(!1),[g,w]=(0,o.useState)([]),[y,N]=(0,o.useState)(null),[x,_]=(0,o.useState)(null),[S,j]=(0,o.useState)(!0),[k,T]=(0,o.useState)(!1),C=`${x}/wp-admin/post-new.php?post_type=m-chart`,O=`${x}/wp-admin/post.php?post=${t.chartId}&action=edit`,$=(0,l.useBlockProps)({className:"m-chart-block-chart-selector"}),F=`?random=${Math.round(1e6*Math.random())}`;(0,o.useEffect)((()=>{A(),P(m)}),[]);const I=a.map((e=>S?(0,n.createElement)("li",{className:e.src?"item img":"item no-image",key:e.id,onClick:()=>B(e.id),title:e.title},e.src?(0,n.createElement)(n.Fragment,null,(0,n.createElement)("h6",{className:"title"},e.title),(0,n.createElement)("img",{src:e.src+F,alt:e.title})):(0,n.createElement)("div",{className:"type"},(0,n.createElement)("span",{className:"icon "+e.type},(0,n.createElement)("h6",{className:"title"},e.title)))):(0,n.createElement)("li",{className:"no-image",key:e.id,onClick:()=>B(e.id),title:e.title},(0,n.createElement)("div",{className:"type"},(0,n.createElement)("span",{className:"icon "+e.type}),(0,n.createElement)("h6",{className:"title"},e.title))))),M=g.filter((e=>e.id===t.chartId))[0],B=e=>{r({chartId:e}),N(e)},A=()=>{s()({path:"/m-chart/v1/options"}).then((e=>{j(e.image_support_active),_(e.siteurl),d(e.maxAvailable)}))},P=e=>{T(!1),s()({path:`/m-chart/v1/graphs/${e}`}).then((e=>{let t=[];v(e[0]),e[1].map((e=>t.push({id:e.id,title:e.title||"-",subtitle:e.subtitle,width:e.width,height:e.height,type:e.type||"",src:e.url||""}))),w(t),i(t),E(!0)})).catch((e=>{"rest_no_route"===e.code&&T(!0)}))},R=(0,n.useCallback)(u()(P,500),[]);return(0,n.createElement)("div",{...$},(0,n.createElement)(l.BlockControls,null,(0,n.createElement)(c.ToolbarGroup,{className:"m-chart-block"},(0,n.createElement)(c.ToolbarButton,{onClick:()=>window.location.href=C,icon:"external"},(0,e.__)("New Chart","m-chart")),t.chartId&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)(c.ToolbarButton,{onClick:()=>window.location.href=O,icon:"external"},(0,e.__)("Edit Chart","m-chart")),(0,n.createElement)(c.ToolbarButton,{onClick:()=>B("")},(0,e.__)("Replace","m-chart"))))),(0,n.createElement)("div",{className:"wp-block m-chart-selector"},(0,n.createElement)("div",{className:"components-placeholder block-editor-m-chart-placeholder is-large"},(0,n.createElement)("div",{className:"components-placeholder__label"},(0,n.createElement)("span",{className:"dashicons dashicons-chart-pie"}),"Chart"),(0,n.createElement)("div",{className:"viewbox"},k?(0,n.createElement)("p",null,(0,e.__)("There was a problem fetching charts","m-chart")):(0,n.createElement)(n.Fragment,null,b?t.chartId?(0,n.createElement)("div",{className:"chart-selected"},S?(0,n.createElement)("div",{className:"image-support"},""===M?.src?(0,n.createElement)("div",{className:"type"},(0,n.createElement)("span",{className:"icon "+M.type}),(0,n.createElement)("h4",{className:"title"},M.title)):(0,n.createElement)("img",{className:"preview",src:M?.src+F})):(0,n.createElement)("div",{className:"no-image-support",style:{aspectRatio:M.width/M.height}},(0,n.createElement)("span",{className:"type "+M.type}),(0,n.createElement)("h4",{className:"title"},M?.title),(0,n.createElement)("p",null,M?.subtitle))):0===h?(0,n.createElement)("p",{className:"center"},(0,e.__)("No Charts found","m-chart"),(0,n.createElement)("a",{href:C},(0,e.__)("Create a new chart","m-chart"))):(0,n.createElement)("div",{className:"no-chart-selected"},(0,n.createElement)("div",{className:"search-box"},(0,n.createElement)(c.TextControl,{value:m,placeholder:(0,e.__)("Search by title","m-chart"),onChange:e=>(e=>{e=e.replace(/[^a-zA-Z0-9\- , ]/gi,""),p(e),R(e)})(e),autoFocus:!0}),(0,n.createElement)("p",{className:"count"},I.length," ",(0,e.__)(" of ","m-chart"),f)),0===I.length&&m.length>1?(0,n.createElement)("p",null,(0,e.__)("No Charts found using this search string","m-chart")):(0,n.createElement)("ul",{className:S?"results image-support":"results no-image-support"},I)):(0,n.createElement)("p",{className:"center"},(0,n.createElement)(c.Spinner,null)))))))},save:()=>null})})()})();